---
import bgImage from "../assets/layers-black-torn-paper.webp";
import { Image } from "astro:assets";
import { db } from "../lib/database";
import { SEO } from "astro-seo";
import SpeedInsights from "@vercel/speed-insights/astro";
import Analytics from "@vercel/analytics/astro";

const {
  pageTitle = `${db.name} ${db.surname} | ${db.profession}`,
  pageDescription = `A professional portfolio showcasing the work of ${db.name} ${db.surname}, ${db.profession}. Explore modern, scalable web applications built with cutting-edge technologies including Next.js, React, TypeScript, and Spring Boot. Featured projects highlight expertise in full-stack development, secure authentication, SEO-optimized architectures, and high-performance UIs.`,
  ogTitle = `${db.name} ${db.surname} | ${db.profession}`,
  ogType = "article",
  ogImage = "/og-image.png",
  canonicalURL = Astro.url.href,
} = Astro.props;
const absoluteOgImageUrl = new URL(ogImage, Astro.site || Astro.url).href;

const originalWidth = bgImage.width;
const originalHeight = bgImage.height;
const sitePublishedDate = new Date().toISOString();
const siteUpdatedDate = new Date().toISOString();
const jsonLdData = {
  "@context": "https://schema.org",
  "@type": "Person",
  name: `${db.name} ${db.surname}`,
  givenName: db.name,
  familyName: db.surname,
  jobTitle: db.profession,
  url: canonicalURL,
  image: absoluteOgImageUrl,
  sameAs: [
    "https://linkedin.com/in/tedymoisa",
    "https://github.com/tedymoisa",
    "https://instagram.com/tedymoisa",
  ],
  alumniOf: {
    "@type": "EducationalOrganization",
    name: "Universit√† degli Studi di Verona",
    url: "https://univr.it",
  },
  knowsAbout: [
    "Web Development",
    "Full-stack Development",
    "Frontend Development",
    "Backend Development",
    "Freelance Development",
    "JavaScript",
    "TypeScript",
    "Java",
    "Golang",
    "React",
    "Next.js",
    "Spring Boot",
    "Database Management",
    "UI/UX Design",
  ],
  worksFor: {
    "@type": "Organization",
    name: "EGON SRL",
    url: "https://egon.com",
  },
  description: pageDescription,
  datePublished: sitePublishedDate,
  dateModified: siteUpdatedDate,
};
---

<!doctype html>
<html lang="en">
  <head>
    <title>{pageTitle}</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={pageDescription} />
    <meta
      name="google-site-verification"
      content="KhBaqrayQ5bmXK6Am3RNCKzGOgovRne1VZrQDGEV6VM"
    />
    <link rel="canonical" href={canonicalURL} />
    <link rel="sitemap" href="/sitemap-index.xml" />

    <SEO
      title={pageTitle}
      description={pageDescription}
      canonical={canonicalURL}
      openGraph={{
        basic: {
          title: ogTitle,
          type: ogType,
          image: absoluteOgImageUrl,
          url: canonicalURL,
        },
        optional: {
          description: pageDescription,
          locale: "en_US",
          siteName: `${db.name} ${db.surname} Portfolio`,
        },
        image: {
          width: 1200,
          height: 630,
          alt: `${ogTitle} - Social sharing image`,
          type: "image/png",
        },
        article: {
          publishedTime: sitePublishedDate,
          modifiedTime: siteUpdatedDate,
          section: db.profession,
          authors: [
            `${db.name} ${db.surname}`,
            "https://linkedin.com/in/tedymoisa",
            "https://github.com/tedymoisa",
            "https://instagram.com/tedymoisa",
          ],
          tags: jsonLdData.knowsAbout,
        },
      }}
      extend={{
        link: [
          {
            rel: "icon",
            type: "image/svg+xml",
            href: "/paw-drawing-white.svg",
          },
        ],
        meta: [
          {
            name: "author",
            content: `${db.name} ${db.surname}`,
          },
        ],
      }}
    />

    <script
      type="application/ld+json"
      set:html={JSON.stringify(jsonLdData)}
      is:inline
    />
  </head>
  <body>
    <Analytics />
    <SpeedInsights />
    <div>{absoluteOgImageUrl}</div>
    <Image
      src={bgImage}
      alt="Abstract black torn paper texture background"
      loading="eager"
      class="full-screen-background"
      width={originalWidth}
      height={originalHeight}
      widths={[360, 720, 1024, 1280, 1536, 1920, 2560, 3840, originalWidth]}
      sizes="100vw"
      priority={true}
    />
    <slot />
  </body>
</html>

<style is:global>
  body {
    margin: 0;
    font-family: "Avenir Next", "Avenir", Helvetica, Arial, sans-serif;
    height: 100dvh;
    overflow: hidden;
  }

  :root {
    --primary: linear-gradient(145deg, #3a3a3a, #606060);
    --front-gloss: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.35),
      transparent
    );
    --back-gloss: repeating-linear-gradient(
      45deg,
      transparent,
      transparent 2px,
      rgba(255, 255, 255, 0.05) 2px,
      rgba(255, 255, 255, 0.05) 4px
    );
    --text-primary: #f0f0f0;
  }

  .full-screen-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    z-index: 0;
    background-color: #333;
  }
</style>
